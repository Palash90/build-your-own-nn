<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>Neural Network: Demystified</title>
    <style>
        /* Highlight for the layer currently being processed */
        .active-layer {
            stroke: #fff !important;
            stroke-width: 3px !important;
            filter: drop-shadow(0 0 8px #00ff00);
        }

        .active-link {
            stroke: #00ff00 !important;
            stroke-width: 2px !important;
            opacity: 1.0 !important;
        }

        body {
            background: #1a1a1a;
            color: #00ff00;
            font-family: 'Courier New', monospace;
            display: flex;
            gap: 20px;
            padding: 20px;
            margin: 0;
            height: 100vh;
            box-sizing: border-box;
        }

        /* Sidebar & Inspector */
        .sidebar {
            width: 380px;
            display: flex;
            flex-direction: column;
            gap: 15px;
            overflow-y: auto;
        }

        .panel {
            background: #2d2d2d;
            border: 1px solid #444;
            padding: 15px;
            border-radius: 8px;
        }

        /* SVG Display */
        #svg-container {
            flex: 1;
            background: #000;
            border: 1px solid #444;
            border-radius: 8px;
            position: relative;
        }

        svg {
            width: 100%;
            height: 100%;
        }

        /* Neuron Styling */
        .neuron-shell {
            fill: #222;
            stroke: #444;
        }

        .stage-linear {
            fill: #111;
            stroke: #0088ff;
            stroke-width: 2;
            cursor: pointer;
            transition: 0.2s;
        }

        .stage-linear:hover {
            fill: #004466;
            r: 9;
        }

        .stage-activation {
            fill: #111;
            stroke: #ff00ff;
            stroke-width: 2;
            cursor: pointer;
            transition: 0.2s;
        }

        .stage-activation:hover {
            fill: #660066;
            r: 9;
        }

        /* Activation Colors */
        .act-relu {
            stroke: #ff00ff;
        }

        .act-sigmoid {
            stroke: #ffff00;
        }

        .act-tanh {
            stroke: #00ffff;
        }

        .act-softmax {
            stroke: #ffffff;
        }

        .act-linear {
            stroke: #888888;
        }

        .link {
            stroke-width: 1;
        }

        /* Inspector Text */
        h4 {
            margin: 0 0 10px 0;
            color: #aaa;
            text-transform: uppercase;
            font-size: 0.8em;
        }

        .data-val {
            color: #fff;
            font-family: monospace;
            font-size: 0.85em;
            word-break: break-all;
            background: #1a1a1a;
            padding: 8px;
            display: block;
            margin-top: 5px;
            border-radius: 4px;
            border-left: 3px solid #444;
        }

        button {
            width: 100%;
            background: #004400;
            color: #00ff00;
            border: 1px solid #00ff00;
            padding: 10px;
            cursor: pointer;
            font-weight: bold;
            margin-top: 10px;
        }

        button:hover {
            background: #00ff00;
            color: #000;
        }
    </style>
</head>

<body>

    <div class="sidebar">
        <div class="panel">
            <h4>Architecture Definition</h4>
            <p style="font-size: 0.7em; color: #888;">Format: nodes:type, nodes:type...</p>
            <input type="text" id="topoInput" value="2:linear, 4:relu, 2:tanh, 4:relu, 5:tanh, 3:softmax"
                style="width:100%; background:#111; color:#00ff00; border:1px solid #00ff00; padding:8px; box-sizing: border-box;">
            <button onclick="initNetwork()">REBUILD & INITIALIZE</button>
        </div>

        <div class="panel">
            <div class="panel">
                <h4>Inference Test</h4>
                <p style="font-size: 0.7em; color: #888;">Input Vector (comma separated):</p>
                <input type="text" id="vectorInput" value="0.5, -0.2"
                    style="width:100%; background:#111; color:#00ff00; border:1px solid #444; padding:8px; box-sizing: border-box;">

                <p style="font-size: 0.7em; color: #888; margin-top: 10px;">Target Vector (for Backprop):</p>
                <input type="text" id="targetInput" value="1.0, 0.0, 0.0"
                    style="width:100%; background:#111; color:#ff00ff; border:1px solid #444; padding:8px; box-sizing: border-box;">

                <button onclick="runInferenceUI()"
                    style="background: #003366; border-color: #0088ff; color: #88ccff;">RUN FULL PASS</button>

                <button onclick="stepDebugger()"
                    style="background: #443300; border-color: #ffaa00; color: #ffaa00;">STEP
                    THROUGH LAYERS</button>
            </div>
        </div>
        <div class="panel">
            <h4>Performance</h4>
            <p>Current Loss: <span id="lossValue" style="color: #ff00ff;">0.0000</span></p>
        </div>

        <div class="panel" id="inspector">
            <h3 style="margin-top:0; color:#00ff00; border-bottom: 1px solid #444; padding-bottom: 10px;">Inspector</h3>
            <div id="inspect-content">
                <p style="color:#666">Click any Blue (Linear) or Pink/Yellow (Activation) circle to see the math
                    buffers.</p>
            </div>
        </div>
    </div>

    <div id="svg-container">
        <svg id="mainSvg">
            <g id="linksGroup"></g>
            <g id="nodesGroup"></g>
        </svg>
    </div>

    <script src="nn.js"></script>
</body>

</html>